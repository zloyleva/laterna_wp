var WPGlobusCustomize;jQuery(document).ready(function(l){"use strict";if(void 0!==WPGlobusCoreData.customize){var s={languages:{},index:0,length:0,positionSet:!1,selectorHtml:'<span style="margin-left:5px;" class="wpglobus-icon-globe"></span><span style="font-weight:bold;">{{language}}</span>',init:function(e){l.each(WPGlobusCoreData.enabled_languages,function(e,t){s.languages[e]=t,s.length=e}),s.addLanguageSelector(),s.setElements(),s.addListeners()},setTitle:function(){l(WPGlobusCoreData.customize.info.element).html(WPGlobusCoreData.customize.info.html)},getString:function(e){var t=WPGlobusCore.getTranslations(e),o=[],a=0;return l.each(t,function(e,t){o[a]=""==t?"null":t,a++}),o=o.join(":::")},setElements:function(){var a;s.setTitle(),l.each(WPGlobusCoreData.customize.addElements,function(e,t){var o=l(t.element);o.attr("id",e).val(t.value).trigger("change"),"textarea"==t.type&&void 0!==t.textarea_attrs&&o.addClass(t.textarea_attrs.class),void 0!==t.options&&(void 0!==t.options.setValue&&t.options.setValue&&(a=l(t.origin_element).val(),o.data("source",a),o.val(WPGlobusCore.TextFilter(a,WPGlobusCoreData.language,"RETURN_EMPTY")),o.hasClass("wpglobus-control-url")&&l(t.origin_element).val(s.getString(a))),void 0!==t.options.setLabel&&t.options.setLabel&&(l(t.title).text(l(t.origin_title).text()),l(t.description).text(l(t.origin_description).text()))),o.on("change",function(e){var t=l(this),o=l(WPGlobusCoreData.customize.addElements[l(this).data("customize-setting-link")].origin_element);t.data("source",WPGlobusCore.getString(t.data("source"),t.val())),t.hasClass("wpglobus-control-url")?o.val(s.getString(t.data("source"))):o.val(WPGlobusCore.getString(o.val(),t.val())),t.hasClass("wpglobus-not-trigger-change")||o.trigger("change")})})},addLanguageSelector:function(){l('<a style="margin-left:48px;" class="customize-controls-close wpglobus-customize-selector"><span class="wpglobus-globe"></span></a>').insertAfter(".customize-controls-preview-toggle"),l(".wpglobus-customize-selector").html(s.selectorHtml.replace("{{language}}",WPGlobusCoreData.language))},setPosition:function(e){void 0!==e.options.setPosition&&e.options.setPosition&&(l(e.parent).detach().insertBefore(e.origin_parent),l(e.parent).css({display:"block"}))},addListeners:function(){l(document).on("click",".control-section",function(e){s.positionSet||(s.positionSet=!0,l.each(WPGlobusCoreData.customize.addElements,function(e,t){l(t.origin_parent).css({display:"none"}),l(t.origin_parent+" label").css({display:"none"}),void 0!==t.options&&s.setPosition(t)}))}),l(document).on("click",".wpglobus-customize-selector",function(e){s.index>s.length-1?s.index=0:s.index++,WPGlobusCoreData.language=s.languages[s.index],l(this).html(s.selectorHtml.replace("{{language}}",WPGlobusCoreData.language)),l(".wpglobus-customize-control").each(function(e,t){if(void 0!==WPGlobusCoreData.customize.addElements[l(t).data("customize-setting-link")]){var o=l(WPGlobusCoreData.customize.addElements[l(t).data("customize-setting-link")].origin_element),a=l(t);a.hasClass("wpglobus-control-url")?a.val(WPGlobusCore.TextFilter(a.data("source"),WPGlobusCoreData.language,"RETURN_EMPTY")):a.val(WPGlobusCore.TextFilter(o.val(),WPGlobusCoreData.language,"RETURN_EMPTY"))}})}),l(document).ajaxSend(function(e,t,o){if(void 0!==o.data&&0<=o.data.indexOf("action=customize_save")){var a,s,n=o.data.split("&");l.each(n,function(e,t){"customized"!=(a=t.split("="))[0]||(s=a[1])});var i=decodeURIComponent(s);i=JSON.parse(i),l.each(WPGlobusCoreData.customize.addElements,function(e,t){void 0!==i[e]&&(i[t.origin]=l(WPGlobusCoreData.customize.addElements[e].origin_element).val())}),o.data=o.data.replace(s,JSON.stringify(i))}})}};(WPGlobusCustomize=l.extend({},WPGlobusCustomize,s)).init()}});