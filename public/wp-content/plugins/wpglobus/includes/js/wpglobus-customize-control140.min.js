jQuery(document).ready(function(a){"use strict";var c={languages:{},index:0,length:0,controlInstances:{},controlWidgets:{},instancesKeep:!1,widgetKeep:!1,action:!1,selectorHtml:'<span style="margin-left:5px;" class="wpglobus-icon-globe"></span><span style="font-weight:bold;">{{language}}</span>',init:function(t){c.setTitle(),"false"!=WPGlobusCustomizeOptions.themeEnabled&&(a.each(WPGlobusCoreData.enabled_languages,function(t,e){c.languages[t]=e,c.length=t}),c.addLanguageSelector(),c.setControlInstances(),c.setFieldsSection(),c.attachListeners())},setFieldsSection:function(){var o={},n=a(".wpglobus-fields_settings_control_box").data("section-template"),s="",l="",i="";a.each(WPGlobusCustomize.controlInstances,function(t,e){void 0===o[e.section]&&(o[e.section]={}),o[e.section][t]=e}),a.each(o,function(t,e){l="<ul>",a.each(e,function(t,e){i=e.userControl.enabled?" checked ":"",l+='<li><input id="wpglobus-cb-control-'+t+'" data-control="'+t+'" class="wpglobus-customize-cb-control" type="checkbox"'+i+" /> "+e.title+"</li>"}),l+="</ul>",s=(s=(s=(s=n.replace("{{section_title}}",wp.customize.section(t).params.title)).replace(/{{section}}/g,t)).replace("{{section_id}}",'"'+t+'"')).replace("{{items}}",l),a(s).insertBefore(a("#"+WPGlobusCustomizeOptions.userControlSaveButton))}),a("#accordion-section-wpglobus_fields_settings_section").css({"margin-top":"15px"}),a(WPGlobusCustomizeOptions.helpButton).insertAfter(a("#accordion-section-wpglobus_fields_settings_section .customize-action")),a("#accordion-section-wpglobus_fields_settings_section .customize-section-description").addClass("hidden"),a("."+WPGlobusCustomizeOptions.userControlIconClass).on("click",function(t){var o=a(this).data("section");a(WPGlobusCustomizeOptions.userControlBoxSelector).each(function(t,e){o==a(e).data("section")?a(this).css({display:"block"}):a(this).css({display:"none"})}),wp.customize.control("wpglobus_fields_settings_section").expand()}),a(".wpglobus-customize-icon-help.customize-help-toggle").on("click",function(t){a("#accordion-section-wpglobus_fields_settings_section .customize-section-description").toggleClass("hidden")})},setUserControls:function(t,e){var o=e.controlSelector+" "+e.selector,n='<img class="'+WPGlobusCustomizeOptions.userControlIconClass+'" data-section="'+e.section+'" style="position:absolute;right:0px;" src="'+WPGlobusCustomizeOptions.userControlIcon+'" />';a(n).insertBefore(o),e.userControl.enabled||(1<a(o).length?a(o).each(function(t,e){a(e).removeClass(WPGlobusCustomize.controlClass)}):a(o).removeClass(WPGlobusCustomize.controlClass).val(e.setting))},ctrlMenuItemsCallback:function(t,e){},ctrlWidgetCallback:function(l,i){if(c.action=!1,void 0===c.controlWidgets[l].element){void 0===i&&(i=wp.customize.control.instance(l)),c.controlWidgets[l].element={},c.controlWidgets[l].control=i,c.controlWidgets[l].inWidgetTitle=i.container.find(".in-widget-title");var t=i.container.find("input[type=submit]");0!=t.length&&(t.css({display:"block"}),t.attr("data-widget",l),c.controlWidgets[l].submit=t,c.attachWidgetListeners(c.controlWidgets[l])),i.liveUpdateMode=!1,void 0===i.setting().title?c.controlWidgets[l].inWidgetTitle.text(""):c.controlWidgets[l].inWidgetTitle.text(": "+WPGlobusCore.TextFilter(i.setting().title,WPGlobusCustomize.languageAdmin)),a.each(WPGlobusCustomize.elementSelector,function(t,n){var s=i.container.find(n);0!=s.length&&a.each(s,function(t,e){if(void 0===e.id||""==e.id)return!0;var o=a(s[t]);void 0===c.controlWidgets[l].element[e.id]&&(c.controlWidgets[l].element[e.id]={}),o.addClass("wpglobus-customize-widget-control"),o.attr("data-widget",l),c.controlWidgets[l].element[e.id].element=o,c.controlWidgets[l].element[e.id].setting=i.setting(),c.controlWidgets[l].element[e.id].selector=n,c.controlWidgets[l].element[e.id].value=e.defaultValue,o.val(WPGlobusCore.TextFilter(e.defaultValue,WPGlobusCoreData.language,"RETURN_EMPTY"))})}),a(document).triggerHandler("wpglobus_customize_control_added_widget",[l])}},ctrlCallback:function(o,n,t){var s=!1;if(a.each(WPGlobusCustomize.disabledSections,function(t,e){if(o.section()==e)return!(s=!0)}),!s&&(a.each(WPGlobusCustomize.disabledSettingMask,function(t,e){if(0<=n.indexOf(e))return!(s=!0)}),!s)){var l=wp.customize.control.instance(n);if(0<=n.indexOf("widget"))return void 0===c.controlWidgets[n]&&(c.controlWidgets[n]={},c.action&&c.ctrlWidgetCallback(n,l)),c.controlWidgets[n].parent=l.selector,!1;if(void 0===c.controlInstances[n]){var i=!0;a.each(WPGlobusCustomize.elementSelector,function(t,e){var o=l.container.find(e);0!=o.length&&(c.controlInstances[n]={},c.controlInstances[n].element=o,c.controlInstances[n].setting=l.setting(),c.controlInstances[n].selector=e,c.controlInstances[n].controlSelector=l.selector,c.controlInstances[n].type="",c.controlInstances[n].section=l.section(),c.controlInstances[n].title=null,c.controlInstances[n].userControl=null,a.each(WPGlobusCustomize.setLinkBy,function(t,e){0<=n.indexOf(e)&&(c.controlInstances[n].type="link",""==c.controlInstances[n].setting&&(c.controlInstances[n].setting=o[0].defaultValue),o.addClass("wpglobus-control-link"))}),""===c.controlInstances[n].type&&(c.controlInstances[n].type="textarea"==e?"textarea":"text"),o.val(WPGlobusCore.TextFilter(c.controlInstances[n].setting,WPGlobusCoreData.language,"RETURN_EMPTY")),o.addClass("wpglobus-customize-control"),o.attr("data-wpglobus-customize-control",c.controlInstances[n].controlSelector.replace("#customize-control-","")),"link"==c.controlInstances[n].type&&(c.controlInstances[n].setting=c.convertString(o[0].defaultValue)),c.controlInstances[n].title=a(l.selector+" .customize-control-title").text(),null!==WPGlobusCustomizeOptions.userControl&&void 0!==WPGlobusCustomizeOptions.userControl[WPGlobusCustomizeOptions.themeName]&&void 0!==WPGlobusCustomizeOptions.userControl[WPGlobusCustomizeOptions.themeName][n]&&"disable"==WPGlobusCustomizeOptions.userControl[WPGlobusCustomizeOptions.themeName][n]&&(i=!1),c.controlInstances[n].userControl={},c.controlInstances[n].userControl.enabled=i,c.setUserControls(n,c.controlInstances[n]))})}}},setControlInstances:function(){wp.customize.control.each(c.ctrlCallback)},setTitle:function(){a(WPGlobusCoreData.customize.info.element).html(WPGlobusCoreData.customize.info.html)},convertString:function(t){if(void 0===t)return t;var o=[],e=WPGlobusCore.getTranslations(t),n=0,s=!0;return a.each(e,function(t,e){""==e?o[n]="null":(s=!1,o[n]=e),n++}),s?"":o.join("|||")},getTranslations:function(t){var o={},n=t.split("|||");return a.each(WPGlobusCoreData.enabled_languages,function(t,e){o[e]="undefined"===n[t]||"null"===n[t]?"":n[t]}),o},getString:function(t,o,n){if(void 0===t)return t;void 0===o&&(o=""),void 0===n&&(n=WPGlobusCoreData.language);var e=c.getTranslations(t),s=[],l=0;return a.each(e,function(t,e){s[l]=t==n?o:""==e?"null":e,l++}),s=s.join("|||")},addLanguageSelector:function(){a(WPGlobusCustomize.selectorButton).insertAfter(".customize-controls-preview-toggle"),a(".wpglobus-customize-selector").html(c.selectorHtml.replace("{{language}}",WPGlobusCoreData.language)),a(document).on("click",".wpglobus-customize-selector",function(t){c.index>c.length-1?c.index=0:c.index++,WPGlobusCoreData.language=c.languages[c.index],a(this).html(c.selectorHtml.replace("{{language}}",WPGlobusCoreData.language)),a(document).triggerHandler("wpglobus_customize_control_language",[WPGlobusCoreData.language]),a(".wpglobus-customize-control").each(function(t,e){var o=a(e),n=o.data("customize-setting-link");if(void 0!==WPGlobusCustomize.controlInstances[n]||(n=o.data("wpglobus-customize-control"),void 0!==WPGlobusCustomize.controlInstances[n]))if(o.hasClass("wpglobus-control-link")){var s=c.getTranslations(WPGlobusCustomize.controlInstances[n].setting);o.val(s[WPGlobusCoreData.language])}else o.val(WPGlobusCore.TextFilter(WPGlobusCustomize.controlInstances[n].setting,WPGlobusCoreData.language,"RETURN_EMPTY"))}),a(".wpglobus-customize-widget-control").each(function(t,e){var o=a(e),n=o.data("widget");if(void 0===o.attr("id"))return!0;o.val(WPGlobusCore.TextFilter(WPGlobusCustomize.controlWidgets[n].element[o.attr("id")].value,WPGlobusCoreData.language,"RETURN_EMPTY"))})})},updateElements:function(s){void 0===s&&(s=!0),a.each(WPGlobusCustomize.controlInstances,function(t,e){if(!e.userControl.enabled)return!0;var o=wp.customize.control.instance(t);if("link"==e.type){var n=c.getTranslations(WPGlobusCustomize.controlInstances[t].setting);s?(o.setting.set(n[WPGlobusCoreData.language]),e.element.val(o.setting())):e.element.val(n[WPGlobusCoreData.language])}else s?(o.setting.set(WPGlobusCore.TextFilter(WPGlobusCustomize.controlInstances[t].setting,WPGlobusCoreData.language,"RETURN_EMPTY")),e.element.val(o.setting())):e.element.val(WPGlobusCore.TextFilter(WPGlobusCustomize.controlInstances[t].setting,WPGlobusCoreData.language,"RETURN_EMPTY"))})},onSubmitEvents:function(t){"mouseenter"==t.type?a.each(c.controlWidgets[a(this).data("widget")].element,function(t,e){a("#"+t).val(e.value)}):"mouseleave"==t.type?c.widgetKeep||a.each(c.controlWidgets[a(this).data("widget")].element,function(t,e){a("#"+t).val(WPGlobusCore.TextFilter(e.value,WPGlobusCoreData.language,"RETURN_EMPTY"))}):"click"==t.type&&(c.widgetKeep=!0)},attachWidgetListeners:function(t){void 0!==t.submit[0].id&&a(document).on("mouseenter","#"+t.submit[0].id,c.onSubmitEvents).on("mouseleave","#"+t.submit[0].id,c.onSubmitEvents).on("click","#"+t.submit[0].id,c.onSubmitEvents)},attachListeners:function(){a(".wpglobus-customize-control").on("keyup",function(t){var e=a(this),o=e.data("customize-setting-link");void 0===WPGlobusCustomize.controlInstances[o]&&(o=e.data("wpglobus-customize-control"),void 0===WPGlobusCustomize.controlInstances[o])||("link"==WPGlobusCustomize.controlInstances[o].type?WPGlobusCustomize.controlInstances[o].setting=c.getString(WPGlobusCustomize.controlInstances[o].setting,e.val(),WPGlobusCoreData.language):WPGlobusCustomize.controlInstances[o].setting=WPGlobusCore.getString(WPGlobusCustomize.controlInstances[o].setting,e.val(),WPGlobusCoreData.language))}),a(document).on("keyup",".wpglobus-customize-widget-control",function(t){var e=a(this),o=e.data("widget");void 0!==WPGlobusCustomize.controlWidgets[o]&&(WPGlobusCustomize.controlWidgets[o].element[e.attr("id")].value=WPGlobusCore.getString(WPGlobusCustomize.controlWidgets[o].element[e.attr("id")].value,e.val(),WPGlobusCoreData.language))}),a("#save").on("mouseenter",function(t){a.each(WPGlobusCustomize.controlInstances,function(t,e){if(e.userControl.enabled){var o=wp.customize.control.instance(t);o.setting.set(e.setting),e.element.val(o.setting())}})}).on("mouseleave",function(t){c.instancesKeep||c.updateElements()}).on("click",function(t){c.instancesKeep=!0}),a(document).on("ajaxComplete",function(t,n){void 0!==n.responseText&&('{"success":true,"data":[]}'==n.responseText?c.updateElements(!1):(0<=n.responseText.indexOf("WP_CUSTOMIZER_SIGNATURE")&&(c.action="customizerAjaxComplete",c.setControlInstances()),a.each(WPGlobusCustomize.controlWidgets,function(t,e){var o=t.replace("_","-");if(0<=n.responseText.indexOf(o))return e.submit.css({display:"block"}),e.control.liveUpdateMode=!1,a.each(e.element,function(t,e){a("#"+t).val(WPGlobusCore.TextFilter(e.value,WPGlobusCoreData.language,"RETURN_EMPTY"))}),e.inWidgetTitle.text(": "+WPGlobusCore.TextFilter(e.control.setting().title,WPGlobusCustomize.languageAdmin)),c.widgetKeep=!1})))}),a(document).on("click",".widget-title, .widget-title-action",function(t){var o=a(this).parents(".customize-control-widget_form").attr("id");a.each(c.controlWidgets,function(t,e){if("#"+o==e.parent)return c.ctrlWidgetCallback(t),!1})})}};WPGlobusCustomize=a.extend({},WPGlobusCustomize,c),WPGlobusCustomize.init()});